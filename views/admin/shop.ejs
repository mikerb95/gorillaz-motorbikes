<%- include('../partials/head', { title: 'Admin — Tienda' }) %>
<main class="container section">
  <h1 class="section-title">Artículos de la Tienda</h1>

  <section class="card stack">
    <h3>Crear artículo</h3>
  <form class="grid two" method="post" action="/admin/tienda/crear">
      <label>Nombre<input name="name" required /></label>
      <label>Precio<input type="number" step="0.01" name="price" required /></label>
      <label>Categoría<input name="category" required /></label>
      <label>Imagen URL<input name="image" placeholder="/images/mi-producto.png" /></label>
      <label class="full">Descripción<textarea name="description" rows="3"></textarea></label>
      <button class="btn btn-primary" type="submit">Crear</button>
    </form>
  </section>

  <section class="section">
    <h3>Lista</h3>
    <div class="grid three">
      <% products.forEach(p => { %>
        <article class="card stack">
          <div class="row gap space-between">
            <h4 class="tight"><%= p.name %></h4>
            <span class="chip">€<%= p.price %></span>
          </div>
          <div class="muted"><%= p.category %></div>
          <p><%= p.description || '' %></p>
          <img src="<%= p.image %>" alt="<%= p.name %>" style="max-height:120px;object-fit:contain;" />
          <div class="row gap">
            <form method="post" action="/admin/tienda/actualizar" class="stack compact">
              <input type="hidden" name="id" value="<%= p.id %>" />
              <input name="name" value="<%= p.name %>" />
              <input type="number" step="0.01" name="price" value="<%= p.price %>" />
              <input name="category" value="<%= p.category %>" />
              <input name="image" value="<%= p.image %>" />
              <textarea name="description" rows="2"><%= p.description || '' %></textarea>
              <button class="btn" type="submit">Actualizar</button>
            </form>
            <form method="post" action="/admin/tienda/eliminar" data-confirm="¿Eliminar este artículo?">
              <input type="hidden" name="id" value="<%= p.id %>" />
              <button class="btn btn-danger" type="submit">Eliminar</button>
            </form>
          </div>
        </article>
      <% }) %>
    </div>
  </section>
</main>
<%- include('../partials/footer') %>
